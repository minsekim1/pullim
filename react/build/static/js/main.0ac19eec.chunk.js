(this["webpackJsonpmeetingsdk-sample-react"]=this["webpackJsonpmeetingsdk-sample-react"]||[]).push([[0],{544:function(e,t,n){},545:function(e,t,n){},603:function(e,t){},605:function(e,t){},614:function(e,t){},615:function(e,t){},623:function(e,t){},626:function(e,t){},627:function(e,t){},628:function(e,t){},629:function(e,t){},630:function(e,t){},631:function(e,t,n){"use strict";n.r(t);var r=n(33),o=n.n(r),i=n(493),a=n.n(i),c=(n(544),n(385)),u=n(1),s=(n(545),n(178)),l=n(31);function f(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{Array:Array,Function:Function},t=e.photoList,n=e.setPhotoList,o=e.setIsModal,i=e.setSrc,a=Object(r.useRef)([]),c=Object(r.useRef)([]),u=function(e,r){var o=t.filter((function(e,t){return r!==t})),i=a.current.filter((function(e,t){return r!==t})),u=c.current.filter((function(e,t){return r!==t}));console.log("\uc0ad\uc81c\ub41c \uac83",r),n(o),a.current=i,c.current=u};return Object(r.useEffect)((function(){return void 0!==a.current&&void 0!==c.current&&t.forEach((function(e,t){var n,r;null===(n=a.current[t])||void 0===n||n.addEventListener("mouseover",(function(){c.current[t].style.display="block"})),null===(r=a.current[t])||void 0===r||r.addEventListener("mouseleave",(function(){c.current[t].style.display="none"}))})),function(){t.forEach((function(e,t){var n,r;void 0!==a.current&&void 0!==c.current&&(null===(n=a.current[t])||void 0===n||n.removeEventListener("mouseover",(function(){c.current[t].style.display="block"})),null===(r=a.current[t])||void 0===r||r.removeEventListener("mouseleave",(function(){c.current[t].style.display="none"})))}))}}),[t]),Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)("h4",{style:{color:"black"},children:"\uc800\uc7a5\ub41c \ud654\uba74\ucea1\ucc98 \ud654\uba74"}),Object(l.jsx)("div",{style:{width:"90%",padding:"10px",height:"90vh",color:"white",display:"flex",flexDirection:"column",alignItems:"center",overflowY:"auto"},children:Object(l.jsx)("div",{style:{minHeight:"500px",width:"100%"},children:0!==t.length&&t.map((function(e,n){return Object(l.jsxs)("div",{ref:function(e){return a.current[n]=e},style:{width:"100%",height:"250px",marginBottom:"10px",position:"relative"},children:[Object(l.jsx)("img",{style:{width:"100%",height:"100%"},src:e.image,alt:"asa",onClick:function(){o(!0),i(t[n].image)}}),Object(l.jsx)("button",{ref:function(e){return c.current[n]=e},style:{position:"absolute",bottom:0,right:2,width:"30px",background:"red",borderRadius:"50px",display:"none"},onClick:function(e){return u(e,n)},children:"x"})]},n)}))})}),Object(l.jsx)("section",{style:{display:"flex",width:"100%"}})]})}var d=n(2),p=n(24),m=n(15),b=n(496);var g=function(e,t,n){var o=Object(r.useRef)(),i=Object(r.useState)(!1),a=Object(u.a)(i,2),c=a[0],s=a[1],l=Object(b.a)({ref:o}),f=l.image,g=l.takeScreenshot,h=Object(r.useCallback)(function(){var n=Object(m.a)(Object(d.a)().mark((function n(r){var o,i;return Object(d.a)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o=new Date,i="photo_".concat(o.getFullYear()).concat(o.getMonth()+1).concat(o.getDate()).concat(o.getHours()).concat(o.getMinutes()).concat(o.getSeconds(),".png"),n.next=4,fetch(r).then((function(e){return e.blob()})).then((function(n){var o=new File([n],i,{type:"image/png"});e([{image:r,name:i,file:o}].concat(Object(p.a)(t)))}));case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),[t,e]);return Object(r.useEffect)((function(){c&&g()}),[c,g]),Object(r.useEffect)((function(){c&&f&&(h(f),s(!1))}),[c,f,h]),{clickCapture:function(){var e;"className"===n.eltype?e=document.querySelector(".".concat(n.elname)):"id"===n.eltype&&(e=document.querySelector("#".concat(n.elname)));var t=e;o.current=t,console.log(o.current),s(!0)},image:f}};var h=function(e){var t=e.setPhotoList,n=e.photoList,r=g(t,n,{eltype:"className",elname:"single-main-container__canvas"}).clickCapture;return Object(l.jsx)(l.Fragment,{children:Object(l.jsx)("button",{id:"screenshot_btn",style:{width:"100px",height:"40px",background:"royalblue",borderRadius:"5px",color:"white",fontSize:"11px",margin:"3px"},onClick:r,children:"\ud654\uba74\ucea1\ucc98"})})};var v=function(e){var t=e.onClickHandler;return Object(l.jsx)("button",{style:{width:"100px",height:"40px",background:"royalblue",borderRadius:"5px",color:"white",fontSize:"11px",margin:"3px"},onClick:t("CheckTool"),children:"\uac80\uc0ac\ud234"})};var j=function(e){var t=e.onClickHandler,n=Object(r.useRef)();return Object(l.jsx)("button",{ref:n,style:{width:"100px",height:"40px",background:"royalblue",borderRadius:"5px",color:"white",fontSize:"11px",margin:"3px"},onClick:t("CaptureList"),children:"\uc800\uc7a5\ub41c \ud654\uba74\ucea1\ucc98 \ud654\uba74"})};var x=function(e){var t=e.onClickHandler;return Object(l.jsx)("button",{onClick:t("RecordAndPrescription"),style:{width:"100px",height:"40px",background:"royalblue",borderRadius:"5px",color:"white",fontSize:"11px",margin:"3px"},children:"\uc9c4\ub2e8 \uae30\ub85d \ubc0f \uc6b4\ub3d9(VOD) \ucc98\ubc29"})};var O=function(e){var t=Object(r.useState)(0),n=Object(u.a)(t,2),o=n[0],i=n[1];return function(t){return function(){var n=document.getElementById("pullim-page");n.style.display=o%2===0?"flex":"none",i(o+1),e(t)}}};var E=function(e){var t=e.onClickHandler;return Object(l.jsx)("button",{style:{width:"100px",height:"40px",background:"royalblue",borderRadius:"5px",color:"white",fontSize:"11px",margin:"3px"},onClick:t("DiagnosticHistory"),children:"\uc9c4\ub2e8\uae30\ub85d"})};var _=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{Function:Function,Array:Array},t=e.setPhotoList,n=e.photoList,o=e.setCurrentPage,i=O(o),a=Object(r.useRef)(),c=Object(r.useRef)();return Object(r.useEffect)((function(){return void 0!==c.current&&void 0!==a.current&&(a.current.addEventListener("mouseover",(function(){c.current.style.display="flex"})),a.current.addEventListener("mouseleave",(function(){c.current.style.display="none"}))),function(){void 0!==c.current&&void 0!==a.current&&(a.current.removeEventListener("mouseover",(function(){c.current.style.display="flex"})),a.current.removeEventListener("mouseleave",(function(){c.current.style.display="none"})))}}),[]),Object(l.jsx)("div",{ref:a,style:{position:"absolute",bottom:"15%",zIndex:100,left:"1%",width:"150px",height:"70%",minHeight:"180px",display:"flex",alignItems:"center"},children:Object(l.jsxs)("div",{ref:c,style:{display:"none",flexDirection:"column",width:"300px"},children:[Object(l.jsx)(j,{onClickHandler:i}),Object(l.jsx)(h,{setPhotoList:t,photoList:n}),Object(l.jsx)(v,{onClickHandler:i}),Object(l.jsx)(x,{onClickHandler:i}),Object(l.jsx)(E,{onClickHandler:i})]})})},R=n(497),T=n.n(R);var C=function(e){var t=e.photoList,n=e.uploadedPhotoList,r=e.setUploadedPhotoList,o=e.videoList,i=e.setVideoList,a=e.memo,c=e.setMemo,u=function(e,t){var n=new FileReader;return new Promise((function(t,r){n.onerror=function(){n.abort(),r(new DOMException("Problem parsing input file."))},n.onload=function(){var r=n.result,o=e.name;t({image:r,name:o,file:e})},n.readAsDataURL(e)}))},s=function(){var e=Object(m.a)(Object(d.a)().mark((function e(t){var o,i;return Object(d.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.target.files,e.prev=1,e.next=4,Promise.all(Array.from(o).map((function(e,t){return u(e)})));case 4:i=e.sent,r.apply(void 0,[i].concat(Object(p.a)(n))),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.log(e.t0.message);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),f=function(){var e=Object(m.a)(Object(d.a)().mark((function e(){var r,i;return Object(d.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=new FormData,i=t.concat(n),""!==a){e.next=4;break}return e.abrupt("return",alert("\uba54\ubaa8\ub97c \uc785\ub825\ud574\uc8fc\uc138\uc694."));case 4:return r.append("memo",a),i.forEach((function(e,t){var n=e.file;r.append("photos",n)})),o.forEach((function(e){var t=e.file;r.append("videos",t)})),e.next=9,T.a.post("/photo",r).then((function(e){return e.data}));case 9:e.sent.success&&alert("\uc800\uc7a5 \uc644\ub8cc!");case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)("h4",{style:{color:"black"},children:"\uc9c4\ub2e8 \uae30\ub85d \ubc0f \uc6b4\ub3d9(VOD) \ucc98\ubc29"}),Object(l.jsxs)("div",{style:{margin:"5px",padding:"0px 10px 0px 10px",width:"90%",height:"90vh",overflowY:"auto"},children:[Object(l.jsx)("h4",{children:"1. \uba54\ubaa8"}),Object(l.jsx)("textarea",{onChange:function(e){c(e.target.value)},value:a,style:{minWidth:"100%",minHeight:"200px",fontSize:"16px",padding:"10px",borderRadius:"3%"}}),Object(l.jsx)("h4",{children:"2. \uc0ac\uc9c4 \uc5c5\ub85c\ub4dc"}),Object(l.jsx)("input",{type:"file",id:"photoSelector",onChange:s,multiple:!0,style:{width:"100%"}}),Object(l.jsx)("h5",{children:"- \uc5c5\ub85c\ub4dc\ud55c \uc0ac\uc9c4(\uc5ec\ub7ec \uc0ac\uc9c4 \uc5c5\ub85c\ub4dc \uac00\ub2a5)"}),Object(l.jsx)("div",{className:"photosContainer",style:{width:"100%"},children:0!==n.length&&n.map((function(e,t){return Object(l.jsx)("div",{className:"photo",style:{width:"100%"},children:Object(l.jsx)("img",{style:{width:"100%"},src:e.image,alt:e.name})},t)}))}),Object(l.jsx)("h5",{children:"- \ucea1\ucc98\ud55c \uc0ac\uc9c4"}),Object(l.jsx)("div",{className:"photosContainer",style:{width:"100%"},children:0!==t.length&&t.map((function(e,t){return Object(l.jsx)("div",{className:"photo",style:{width:"100%"},children:Object(l.jsx)("img",{style:{width:"100%"},src:e.image,alt:e.name})},t)}))}),Object(l.jsx)("h4",{children:"3. \uc6b4\ub3d9 VOD\ucc98\ubc29\ud558\uae30"}),Object(l.jsx)("input",{type:"file",id:"videoSelector",onChange:function(e){if(e.target.files){var t=e.target.files,n=Array.from(t).map((function(e){return{name:e.name,file:e}}));i(n)}},multiple:!0,style:{width:"100%"}}),Object(l.jsx)("div",{})]}),Object(l.jsx)("button",{style:{width:"100%",height:"10vh",background:"red",borderRadius:"5px",color:"white",fontSize:"11px"},onClick:f,children:"\ucc98\ubc29\uc804 \uc800\uc7a5"})]})},F=n(382),y={"640x360":[640,360],"256x256":[256,256],"256x144":[256,144],"160x96":[160,96]};function S(e,t){switch(e){case"meet":return"256x144"===t?"segm_full_v679":"segm_lite_v681";case"mlkit":return"selfiesegmentation_mlkit-256x256-2021_01_19-v1215.f16";default:throw new Error("No TFLite file for this segmentation model: ".concat(e))}}function A(e,t,n,r,o,i,a){var c=r.getContext("2d"),s=Object(u.a)(y[n.inputResolution],2),l=s[0],f=s[1],p=l*f,b=new ImageData(l,f),g=document.createElement("canvas");g.width=l,g.height=f;var h,v=g.getContext("2d"),j=i._getInputMemoryOffset()/4,x=i._getOutputMemoryOffset()/4;function O(){return(O=Object(m.a)(Object(d.a)().mark((function e(){return Object(d.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("none"!==t.type&&E(),a(),"none"===t.type){e.next=9;break}if("bodyPix"!==n.model){e.next=8;break}return e.next=6,_();case 6:e.next=9;break;case 8:T();case 9:a(),C();case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function E(){if(v.drawImage(e.htmlElement,0,0,e.width,e.height,0,0,l,f),"meet"===n.model||"mlkit"===n.model)for(var t=v.getImageData(0,0,l,f),r=0;r<p;r++)i.HEAPF32[j+3*r]=t.data[4*r]/255,i.HEAPF32[j+3*r+1]=t.data[4*r+1]/255,i.HEAPF32[j+3*r+2]=t.data[4*r+2]/255}function _(){return R.apply(this,arguments)}function R(){return(R=Object(m.a)(Object(d.a)().mark((function e(){var t,n;return Object(d.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.segmentPerson(g);case 2:for(t=e.sent,n=0;n<p;n++)b.data[4*n+3]=t.data[n]?255:0;v.putImageData(b,0,0);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function T(){i._runInference();for(var e=0;e<p;e++)if("meet"===n.model){var t=i.HEAPF32[x+2*e],r=i.HEAPF32[x+2*e+1],o=Math.max(t,r),a=Math.exp(t-o),c=Math.exp(r-o);b.data[4*e+3]=255*c/(a+c)}else if("mlkit"===n.model){var u=i.HEAPF32[x+e];b.data[4*e+3]=255*u}v.putImageData(b,0,0)}function C(){var n;c.globalCompositeOperation="copy",c.filter="none",null!==(n=h)&&void 0!==n&&n.smoothSegmentationMask&&("blur"===t.type?c.filter="blur(8px)":"image"===t.type&&(c.filter="blur(4px)")),"none"!==t.type&&(c.drawImage(g,0,0,l,f,0,0,e.width,e.height),c.globalCompositeOperation="source-in",c.filter="none"),c.drawImage(e.htmlElement,0,0),"blur"===t.type&&(c.globalCompositeOperation="destination-over",c.filter="blur(8px)",c.drawImage(e.htmlElement,0,0))}return{render:function(){return O.apply(this,arguments)},updatePostProcessingConfig:function(e){h=e},cleanUp:function(){}}}var w,k,P,U,M,L,D,I,B,N,H=n(101),X=String.raw;function W(e,t,n,r,o){var i=function(e,t,n){var r=e.createProgram();if(e.attachShader(r,t),e.attachShader(r,n),e.linkProgram(r),!e.getProgramParameter(r,e.LINK_STATUS))throw new Error("Could not link WebGL program: ".concat(e.getProgramInfoLog(r)));return r}(e,t,n),a=e.getAttribLocation(i,"a_position");e.enableVertexAttribArray(a),e.bindBuffer(e.ARRAY_BUFFER,r),e.vertexAttribPointer(a,2,e.FLOAT,!1,0,0);var c=e.getAttribLocation(i,"a_texCoord");return e.enableVertexAttribArray(c),e.bindBuffer(e.ARRAY_BUFFER,o),e.vertexAttribPointer(c,2,e.FLOAT,!1,0,0),i}function G(e,t,n){var r=e.createShader(t);if(e.shaderSource(r,n),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS))throw new Error("Could not compile shader: ".concat(e.getShaderInfoLog(r)));return r}function z(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:e.NEAREST,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:e.NEAREST,a=e.createTexture();return e.bindTexture(e.TEXTURE_2D,a),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,o),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,i),e.texStorage2D(e.TEXTURE_2D,1,t,n,r),a}function V(){return(V=Object(m.a)(Object(d.a)().mark((function e(t,n,r,o,i,a,c,u){var s;return Object(d.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=t.createBuffer(),t.bindBuffer(t.PIXEL_PACK_BUFFER,s),t.bufferData(t.PIXEL_PACK_BUFFER,u.byteLength,t.STREAM_READ),t.readPixels(n,r,o,i,a,c,0),t.bindBuffer(t.PIXEL_PACK_BUFFER,null),e.next=7,Y(t,t.PIXEL_PACK_BUFFER,s,0,u);case 7:return t.deleteBuffer(s),e.abrupt("return",u);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Y(e,t,n,r,o,i,a){return K.apply(this,arguments)}function K(){return(K=Object(m.a)(Object(d.a)().mark((function e(t,n,r,o,i,a,c){var u,s;return Object(d.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=t.fenceSync(t.SYNC_GPU_COMMANDS_COMPLETE,0),t.flush(),e.next=4,Z(t,u);case 4:s=e.sent,t.deleteSync(u),s!==t.WAIT_FAILED&&(t.bindBuffer(n,r),t.getBufferSubData(n,o,i,a,c),t.bindBuffer(n,null));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Z(e,t){return new Promise((function(n){requestAnimationFrame((function r(){var o=e.clientWaitSync(t,0,0);o!==e.WAIT_FAILED?o!==e.TIMEOUT_EXPIRED?n(o):requestAnimationFrame(r):n(o)}))}))}function q(e,t,n,r,o,i){var a=function(e,t,n,r,o,i){var a=X(w||(w=Object(H.a)(["#version 300 es\n\n    precision highp float;\n\n    uniform sampler2D u_inputFrame;\n    uniform sampler2D u_personMask;\n    uniform vec2 u_texelSize;\n\n    in vec2 v_texCoord;\n\n    out vec4 outColor;\n\n    const float offset[5] = float[](0.0, 1.0, 2.0, 3.0, 4.0);\n    const float weight[5] = float[](0.2270270270, 0.1945945946, 0.1216216216,\n      0.0540540541, 0.0162162162);\n\n    void main() {\n      vec4 centerColor = texture(u_inputFrame, v_texCoord);\n      float personMask = texture(u_personMask, v_texCoord).a;\n\n      vec4 frameColor = centerColor * weight[0] * (1.0 - personMask);\n\n      for (int i = 1; i < 5; i++) {\n        vec2 offset = vec2(offset[i]) * u_texelSize;\n\n        vec2 texCoord = v_texCoord + offset;\n        frameColor += texture(u_inputFrame, texCoord) * weight[i] *\n          (1.0 - texture(u_personMask, texCoord).a);\n\n        texCoord = v_texCoord - offset;\n        frameColor += texture(u_inputFrame, texCoord) * weight[i] *\n          (1.0 - texture(u_personMask, texCoord).a);\n      }\n      outColor = vec4(frameColor.rgb + (1.0 - frameColor.a) * centerColor.rgb, 1.0);\n    }\n  "]))),c=.5,u=i.width*c,s=i.height*c,l=1/u,f=1/s,d=G(e,e.FRAGMENT_SHADER,a),p=W(e,t,d,n,r),m=e.getUniformLocation(p,"u_inputFrame"),b=e.getUniformLocation(p,"u_personMask"),g=e.getUniformLocation(p,"u_texelSize"),h=z(e,e.RGBA8,u,s,e.NEAREST,e.LINEAR),v=z(e,e.RGBA8,u,s,e.NEAREST,e.LINEAR),j=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,j),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,h,0);var x=e.createFramebuffer();function O(){e.viewport(0,0,u,s),e.useProgram(p),e.uniform1i(m,0),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,o);for(var t=0;t<3;t++)e.uniform2f(g,0,f),e.bindFramebuffer(e.FRAMEBUFFER,j),e.drawArrays(e.TRIANGLE_STRIP,0,4),e.activeTexture(e.TEXTURE2),e.bindTexture(e.TEXTURE_2D,h),e.uniform1i(m,2),e.uniform2f(g,l,0),e.bindFramebuffer(e.FRAMEBUFFER,x),e.drawArrays(e.TRIANGLE_STRIP,0,4),e.bindTexture(e.TEXTURE_2D,v)}function E(){e.deleteFramebuffer(x),e.deleteFramebuffer(j),e.deleteTexture(v),e.deleteTexture(h),e.deleteProgram(p),e.deleteShader(d)}return e.bindFramebuffer(e.FRAMEBUFFER,x),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,v,0),e.useProgram(p),e.uniform1i(b,1),{render:O,cleanUp:E}}(e,t,n,r,o,i),c=function(e,t,n,r){var o=X(k||(k=Object(H.a)(["#version 300 es\n\n    in vec2 a_position;\n    in vec2 a_texCoord;\n\n    out vec2 v_texCoord;\n\n    void main() {\n      // Flipping Y is required when rendering to canvas\n      gl_Position = vec4(a_position * vec2(1.0, -1.0), 0.0, 1.0);\n      v_texCoord = a_texCoord;\n    }\n  "]))),i=X(P||(P=Object(H.a)(["#version 300 es\n\n    precision highp float;\n\n    uniform sampler2D u_inputFrame;\n    uniform sampler2D u_personMask;\n    uniform sampler2D u_blurredInputFrame;\n    uniform vec2 u_coverage;\n\n    in vec2 v_texCoord;\n\n    out vec4 outColor;\n\n    void main() {\n      vec3 color = texture(u_inputFrame, v_texCoord).rgb;\n      vec3 blurredColor = texture(u_blurredInputFrame, v_texCoord).rgb;\n      float personMask = texture(u_personMask, v_texCoord).a;\n      personMask = smoothstep(u_coverage.x, u_coverage.y, personMask);\n      outColor = vec4(mix(blurredColor, color, personMask), 1.0);\n    }\n  "]))),a=r.width,c=r.height,u=G(e,e.VERTEX_SHADER,o),s=G(e,e.FRAGMENT_SHADER,i),l=W(e,u,s,t,n),f=e.getUniformLocation(l,"u_inputFrame"),d=e.getUniformLocation(l,"u_personMask"),p=e.getUniformLocation(l,"u_blurredInputFrame"),m=e.getUniformLocation(l,"u_coverage");function b(){e.viewport(0,0,a,c),e.useProgram(l),e.bindFramebuffer(e.FRAMEBUFFER,null),e.drawArrays(e.TRIANGLE_STRIP,0,4)}function g(t){e.useProgram(l),e.uniform2f(m,t[0],t[1])}function h(){e.deleteProgram(l),e.deleteShader(s),e.deleteShader(u)}return e.useProgram(l),e.uniform1i(f,0),e.uniform1i(d,1),e.uniform1i(p,2),e.uniform2f(m,0,1),{render:b,updateCoverage:g,cleanUp:h}}(e,n,r,i);return{render:function(){a.render(),c.render()},updateCoverage:function(e){c.updateCoverage(e)},cleanUp:function(){c.cleanUp(),a.cleanUp()}}}function J(e,t,n,r,o,i){var a=X(I||(I=Object(H.a)(["#version 300 es\n\n    precision highp float;\n\n    uniform sampler2D u_inputFrame;\n\n    in vec2 v_texCoord;\n\n    out vec4 outColor;\n\n    void main() {\n      outColor = texture(u_inputFrame, v_texCoord);\n    }\n  "]))),c=i._getInputMemoryOffset()/4,s=Object(u.a)(y[o.inputResolution],2),l=s[0],f=s[1],d=l*f,p=G(e,e.FRAGMENT_SHADER,a),m=W(e,t,p,n,r),b=e.getUniformLocation(m,"u_inputFrame"),g=z(e,e.RGBA8,l,f),h=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,h),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,g,0);var v=new Uint8Array(4*d);return e.useProgram(m),e.uniform1i(b,0),{render:function(){e.viewport(0,0,l,f),e.useProgram(m),e.bindFramebuffer(e.FRAMEBUFFER,h),e.drawArrays(e.TRIANGLE_STRIP,0,4),function(e,t,n,r,o,i,a,c){V.apply(this,arguments)}(e,0,0,l,f,e.RGBA,e.UNSIGNED_BYTE,v);for(var t=0;t<d;t++){var n=c+3*t,r=4*t;i.HEAPF32[n]=v[r]/255,i.HEAPF32[n+1]=v[r+1]/255,i.HEAPF32[n+2]=v[r+2]/255}},cleanUp:function(){e.deleteFramebuffer(h),e.deleteTexture(g),e.deleteProgram(m),e.deleteShader(p)}}}function Q(e,t,n,r,o,i,a){var c=X(N||(N=Object(H.a)(["#version 300 es\n\n    in vec2 a_position;\n    in vec2 a_texCoord;\n\n    out vec2 v_texCoord;\n\n    void main() {\n      gl_Position = vec4(a_position, 0.0, 1.0);\n      v_texCoord = a_texCoord;\n    }\n  "]))),s=e.width,l=e.height,f=Object(u.a)(y[r.inputResolution],2),p=f[0],b=f[1],g=o.getContext("webgl2",{preserveDrawingBuffer:!0}),h=G(g,g.VERTEX_SHADER,c),v=g.createVertexArray();g.bindVertexArray(v);var j=g.createBuffer();g.bindBuffer(g.ARRAY_BUFFER,j),g.bufferData(g.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,1,1]),g.STATIC_DRAW);var x=g.createBuffer();g.bindBuffer(g.ARRAY_BUFFER,x),g.bufferData(g.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,1,1]),g.STATIC_DRAW);var O=g.createTexture();g.bindTexture(g.TEXTURE_2D,O),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,g.CLAMP_TO_EDGE),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,g.CLAMP_TO_EDGE),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,g.NEAREST),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,g.NEAREST);var E=z(g,g.RGBA8,p,b),_=z(g,g.RGBA8,s,l),R=J(g,h,j,x,r,i),T="meet"===r.model?function(e,t,n,r,o,i,a){var c=X(B||(B=Object(H.a)(["#version 300 es\n\n    precision highp float;\n\n    uniform sampler2D u_inputSegmentation;\n\n    in vec2 v_texCoord;\n\n    out vec4 outColor;\n\n    void main() {\n      vec2 segmentation = texture(u_inputSegmentation, v_texCoord).rg;\n      float shift = max(segmentation.r, segmentation.g);\n      float backgroundExp = exp(segmentation.r - shift);\n      float personExp = exp(segmentation.g - shift);\n      outColor = vec4(vec3(0.0), personExp / (backgroundExp + personExp));\n    }\n  "]))),s=i._getOutputMemoryOffset()/4,l=Object(u.a)(y[o.inputResolution],2),f=l[0],d=l[1],p=G(e,e.FRAGMENT_SHADER,c),m=W(e,t,p,n,r),b=e.getUniformLocation(m,"u_inputSegmentation"),g=z(e,e.RG32F,f,d),h=e.createFramebuffer();return e.bindFramebuffer(e.FRAMEBUFFER,h),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,a,0),e.useProgram(m),e.uniform1i(b,1),{render:function(){e.viewport(0,0,f,d),e.useProgram(m),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,g),e.texSubImage2D(e.TEXTURE_2D,0,0,0,f,d,e.RG,e.FLOAT,i.HEAPF32,s),e.bindFramebuffer(e.FRAMEBUFFER,h),e.drawArrays(e.TRIANGLE_STRIP,0,4)},cleanUp:function(){e.deleteFramebuffer(h),e.deleteTexture(g),e.deleteProgram(m),e.deleteShader(p)}}}(g,h,j,x,r,i,E):function(e,t,n,r,o,i,a){var c=X(D||(D=Object(H.a)(["#version 300 es\n\n    precision highp float;\n\n    uniform sampler2D u_inputSegmentation;\n\n    in vec2 v_texCoord;\n\n    out vec4 outColor;\n\n    void main() {\n      float segmentation = texture(u_inputSegmentation, v_texCoord).r;\n      outColor = vec4(vec3(0.0), segmentation);\n    }\n  "]))),s=i._getOutputMemoryOffset()/4,l=Object(u.a)(y[o.inputResolution],2),f=l[0],d=l[1],p=G(e,e.FRAGMENT_SHADER,c),m=W(e,t,p,n,r),b=e.getUniformLocation(m,"u_inputSegmentation"),g=z(e,e.R32F,f,d),h=e.createFramebuffer();return e.bindFramebuffer(e.FRAMEBUFFER,h),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,a,0),e.useProgram(m),e.uniform1i(b,1),{render:function(){e.viewport(0,0,f,d),e.useProgram(m),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,g),e.texSubImage2D(e.TEXTURE_2D,0,0,0,f,d,e.RED,e.FLOAT,i.HEAPF32,s),e.bindFramebuffer(e.FRAMEBUFFER,h),e.drawArrays(e.TRIANGLE_STRIP,0,4)},cleanUp:function(){e.deleteFramebuffer(h),e.deleteTexture(g),e.deleteProgram(m),e.deleteShader(p)}}}(g,h,j,x,r,i,E),C=function(e,t,n,r,o,i,a,c){var s=X(L||(L=Object(H.a)(["#version 300 es\n\n    precision highp float;\n\n    uniform sampler2D u_inputFrame;\n    uniform sampler2D u_segmentationMask;\n    uniform vec2 u_texelSize;\n    uniform float u_step;\n    uniform float u_radius;\n    uniform float u_offset;\n    uniform float u_sigmaTexel;\n    uniform float u_sigmaColor;\n\n    in vec2 v_texCoord;\n\n    out vec4 outColor;\n\n    float gaussian(float x, float sigma) {\n      float coeff = -0.5 / (sigma * sigma * 4.0 + 1.0e-6);\n      return exp((x * x) * coeff);\n    }\n\n    void main() {\n      vec2 centerCoord = v_texCoord;\n      vec3 centerColor = texture(u_inputFrame, centerCoord).rgb;\n      float newVal = 0.0;\n\n      float spaceWeight = 0.0;\n      float colorWeight = 0.0;\n      float totalWeight = 0.0;\n\n      // Subsample kernel space.\n      for (float i = -u_radius + u_offset; i <= u_radius; i += u_step) {\n        for (float j = -u_radius + u_offset; j <= u_radius; j += u_step) {\n          vec2 shift = vec2(j, i) * u_texelSize;\n          vec2 coord = vec2(centerCoord + shift);\n          vec3 frameColor = texture(u_inputFrame, coord).rgb;\n          float outVal = texture(u_segmentationMask, coord).a;\n\n          spaceWeight = gaussian(distance(centerCoord, coord), u_sigmaTexel);\n          colorWeight = gaussian(distance(centerColor, frameColor), u_sigmaColor);\n          totalWeight += spaceWeight * colorWeight;\n\n          newVal += spaceWeight * colorWeight * outVal;\n        }\n      }\n      newVal /= totalWeight;\n\n      outColor = vec4(vec3(0.0), newVal);\n    }\n  "]))),l=Object(u.a)(y[i.inputResolution],2),f=l[0],d=l[1],p=c.width,m=c.height,b=1/p,g=1/m,h=G(e,e.FRAGMENT_SHADER,s),v=W(e,t,h,n,r),j=e.getUniformLocation(v,"u_inputFrame"),x=e.getUniformLocation(v,"u_segmentationMask"),O=e.getUniformLocation(v,"u_texelSize"),E=e.getUniformLocation(v,"u_step"),_=e.getUniformLocation(v,"u_radius"),R=e.getUniformLocation(v,"u_offset"),T=e.getUniformLocation(v,"u_sigmaTexel"),C=e.getUniformLocation(v,"u_sigmaColor"),F=e.createFramebuffer();function S(t){t*=Math.max(p/f,m/d);var n=Math.max(1,.66*Math.sqrt(t)),r=t,o=n>1?.5*n:0,i=Math.max(b,g)*t;e.useProgram(v),e.uniform1f(E,n),e.uniform1f(_,r),e.uniform1f(R,o),e.uniform1f(T,i)}function A(t){e.useProgram(v),e.uniform1f(C,t)}return e.bindFramebuffer(e.FRAMEBUFFER,F),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,a,0),e.useProgram(v),e.uniform1i(j,0),e.uniform1i(x,1),e.uniform2f(O,b,g),S(0),A(0),{render:function(){e.viewport(0,0,p,m),e.useProgram(v),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,o),e.bindFramebuffer(e.FRAMEBUFFER,F),e.drawArrays(e.TRIANGLE_STRIP,0,4)},updateSigmaSpace:S,updateSigmaColor:A,cleanUp:function(){e.deleteFramebuffer(F),e.deleteProgram(v),e.deleteShader(h)}}}(g,h,j,x,E,r,_,o),F="blur"===n.type?q(g,h,j,x,_,o):function(e,t,n,r,o,i){var a=X(U||(U=Object(H.a)(["#version 300 es\n\n    uniform vec2 u_backgroundScale;\n    uniform vec2 u_backgroundOffset;\n\n    in vec2 a_position;\n    in vec2 a_texCoord;\n\n    out vec2 v_texCoord;\n    out vec2 v_backgroundCoord;\n\n    void main() {\n      // Flipping Y is required when rendering to canvas\n      gl_Position = vec4(a_position * vec2(1.0, -1.0), 0.0, 1.0);\n      v_texCoord = a_texCoord;\n      v_backgroundCoord = a_texCoord * u_backgroundScale + u_backgroundOffset;\n    }\n  "]))),c=X(M||(M=Object(H.a)(["#version 300 es\n\n    precision highp float;\n\n    uniform sampler2D u_inputFrame;\n    uniform sampler2D u_personMask;\n    uniform sampler2D u_background;\n    uniform vec2 u_coverage;\n    uniform float u_lightWrapping;\n    uniform float u_blendMode;\n\n    in vec2 v_texCoord;\n    in vec2 v_backgroundCoord;\n\n    out vec4 outColor;\n\n    vec3 screen(vec3 a, vec3 b) {\n      return 1.0 - (1.0 - a) * (1.0 - b);\n    }\n\n    vec3 linearDodge(vec3 a, vec3 b) {\n      return a + b;\n    }\n\n    void main() {\n      vec3 frameColor = texture(u_inputFrame, v_texCoord).rgb;\n      vec3 backgroundColor = texture(u_background, v_backgroundCoord).rgb;\n      float personMask = texture(u_personMask, v_texCoord).a;\n      float lightWrapMask = 1.0 - max(0.0, personMask - u_coverage.y) / (1.0 - u_coverage.y);\n      vec3 lightWrap = u_lightWrapping * lightWrapMask * backgroundColor;\n      frameColor = u_blendMode * linearDodge(frameColor, lightWrap) +\n        (1.0 - u_blendMode) * screen(frameColor, lightWrap);\n      personMask = smoothstep(u_coverage.x, u_coverage.y, personMask);\n      outColor = vec4(frameColor * personMask + backgroundColor * (1.0 - personMask), 1.0);\n    }\n  "]))),u=i.width,s=i.height,l=u/s,f=G(e,e.VERTEX_SHADER,a),d=G(e,e.FRAGMENT_SHADER,c),p=W(e,f,d,t,n),m=e.getUniformLocation(p,"u_backgroundScale"),b=e.getUniformLocation(p,"u_backgroundOffset"),g=e.getUniformLocation(p,"u_inputFrame"),h=e.getUniformLocation(p,"u_personMask"),v=e.getUniformLocation(p,"u_background"),j=e.getUniformLocation(p,"u_coverage"),x=e.getUniformLocation(p,"u_lightWrapping"),O=e.getUniformLocation(p,"u_blendMode");e.useProgram(p),e.uniform2f(m,1,1),e.uniform2f(b,0,0),e.uniform1i(g,0),e.uniform1i(h,1),e.uniform2f(j,0,1),e.uniform1f(x,0),e.uniform1f(O,0);var E=null;function _(t){E=z(e,e.RGBA8,t.naturalWidth,t.naturalHeight,e.LINEAR,e.LINEAR),e.texSubImage2D(e.TEXTURE_2D,0,0,0,t.naturalWidth,t.naturalHeight,e.RGBA,e.UNSIGNED_BYTE,t);var n=0,r=0,o=t.naturalWidth,i=t.naturalHeight;o/i<l?(i=o/l,r=(t.naturalHeight-i)/2):(o=i*l,n=(t.naturalWidth-o)/2);var a=o/t.naturalWidth,c=i/t.naturalHeight;n/=t.naturalWidth,r/=t.naturalHeight,e.uniform2f(m,a,c),e.uniform2f(b,n,r)}return null!==o&&void 0!==o&&o.complete?_(o):o&&(o.onload=function(){_(o)}),{render:function(){e.viewport(0,0,u,s),e.useProgram(p),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,r),null!==E&&(e.activeTexture(e.TEXTURE2),e.bindTexture(e.TEXTURE_2D,E),e.uniform1i(v,2)),e.bindFramebuffer(e.FRAMEBUFFER,null),e.drawArrays(e.TRIANGLE_STRIP,0,4)},updateCoverage:function(t){e.useProgram(p),e.uniform2f(j,t[0],t[1])},updateLightWrapping:function(t){e.useProgram(p),e.uniform1f(x,t)},updateBlendMode:function(t){e.useProgram(p),e.uniform1f(O,"screen"===t?0:1)},cleanUp:function(){e.deleteTexture(E),e.deleteProgram(p),e.deleteShader(d),e.deleteShader(f)}}}(g,j,x,_,t,o);function S(){return(S=Object(m.a)(Object(d.a)().mark((function t(){return Object(d.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:g.clearColor(0,0,0,0),g.clear(g.COLOR_BUFFER_BIT),g.activeTexture(g.TEXTURE0),g.bindTexture(g.TEXTURE_2D,O),g.texImage2D(g.TEXTURE_2D,0,g.RGBA,g.RGBA,g.UNSIGNED_BYTE,e.htmlElement),g.bindVertexArray(v),R.render(),a(),i._runInference(),a(),T.render(),C.render(),F.render();case 13:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return{render:function(){return S.apply(this,arguments)},updatePostProcessingConfig:function(e){if(C.updateSigmaSpace(e.jointBilateralFilter.sigmaSpace),C.updateSigmaColor(e.jointBilateralFilter.sigmaColor),"image"===n.type){var t=F;t.updateCoverage(e.coverage),t.updateLightWrapping(e.lightWrapping),t.updateBlendMode(e.blendMode)}else if("blur"===n.type){F.updateCoverage(e.coverage)}else{var r=F;r.updateCoverage([0,.9999]),r.updateLightWrapping(0)}},cleanUp:function(){F.cleanUp(),C.cleanUp(),T.cleanUp(),R.cleanUp(),g.deleteTexture(_),g.deleteTexture(E),g.deleteTexture(O),g.deleteBuffer(x),g.deleteBuffer(j),g.deleteVertexArray(v),g.deleteShader(h)}}}var $=function(e,t,n,o,i){var a=Object(r.useState)(null),c=Object(u.a)(a,2),s=c[0],l=c[1],f=Object(r.useRef)(null),p=Object(r.useRef)(null),b=Object(r.useState)(0),g=Object(u.a)(b,2),h=g[0],v=g[1],j=Object(r.useState)([]),x=Object(u.a)(j,2),O=x[0],E=x[1];return Object(r.useEffect)((function(){var r,a=!0,c=0,u=0,s=0,b=0,g=[],h="webgl2"===n.pipeline?Q(e,f.current,t,n,p.current,i,_):A(e,t,n,p.current,o,i,_);function j(){return x.apply(this,arguments)}function x(){return(x=Object(m.a)(Object(d.a)().mark((function e(){return Object(d.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=2;break}return e.abrupt("return");case 2:return O(),e.next=5,h.render();case 5:R(),r=requestAnimationFrame(j);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function O(){u=Date.now()}function _(){var e=Date.now();g[s]=e-u,u=e,s++}function R(){var e=Date.now();g[s]=e-u,b++,e>=c+1e3&&(v(1e3*b/(e-c)),E(g),c=e,b=0),s=0}return j(),console.log("Animation started:",e,t,n),l(h),function(){a=!1,cancelAnimationFrame(r),h.cleanUp(),console.log("Animation stopped:",e,t,n),l(null)}}),[e,t,n,o,i]),{pipeline:s,backgroundImageRef:f,canvasRef:p,fps:h,durations:O}};var ee=function(e){var t=$(e.sourcePlayback,e.backgroundConfig,e.segmentationConfig,e.bodyPix,e.tflite),n=t.pipeline,o=t.backgroundImageRef,i=t.canvasRef;return Object(r.useEffect)((function(){n&&n.updatePostProcessingConfig(e.postProcessingConfig)}),[n,e.postProcessingConfig]),Object(l.jsx)(l.Fragment,{children:Object(l.jsxs)("div",{style:{width:"400px",height:"250px",position:"absolute",right:"0"},children:["image"===e.backgroundConfig.type&&Object(l.jsx)("img",{ref:o,src:e.backgroundConfig.url,alt:"",hidden:"webgl2"===e.segmentationConfig.pipeline,style:{position:"absolute",width:"100%",height:"100%",objectFit:"cover"}}),Object(l.jsx)("canvas",{id:"grid-bg-photo",ref:i,width:e.sourcePlayback.width,height:e.sourcePlayback.height,style:{position:"absolute",width:"100%",height:"100%",objectFit:"cover"}},e.segmentationConfig.pipeline)]})})},te=n(369),ne=n.n(te),re=["grid_background"].map((function(e){return"".concat("","/backgrounds/").concat(e,".png")})),oe=n(538),ie=n(537);var ae=function(){var e=Object(r.useState)(),t=Object(u.a)(e,2),n=t[0],o=t[1];return Object(r.useEffect)((function(){function e(){return(e=Object(m.a)(Object(d.a)().mark((function e(){return Object(d.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Loading TensorFlow.js and BodyPix segmentation model"),e.next=3,ie.a();case 3:return e.t0=o,e.next=6,oe.a();case 6:e.t1=e.sent,(0,e.t0)(e.t1),console.log("TensorFlow.js and BodyPix loaded");case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),n};var ce=function(e){var t=Object(r.useState)(),n=Object(u.a)(t,2),o=n[0],i=n[1],a=Object(r.useState)(),c=Object(u.a)(a,2),s=c[0],l=c[1],f=Object(r.useState)(),p=Object(u.a)(f,2),b=p[0],g=p[1],h=Object(r.useState)(!1),v=Object(u.a)(h,2),j=v[0],x=v[1];return Object(r.useEffect)((function(){function e(){return(e=Object(m.a)(Object(d.a)().mark((function e(){var t;return Object(d.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return createTFLiteModule().then(i),e.prev=1,e.next=4,createTFLiteSIMDModule();case 4:t=e.sent,l(t),x(!0),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.warn("Failed to create TFLite SIMD WebAssembly module.",e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),Object(r.useEffect)((function(){function t(){return(t=Object(m.a)(Object(d.a)().mark((function t(){var n,r,i,a,c;return Object(d.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(!o||j&&!s||!j&&"wasmSimd"===e.backend||"meet"!==e.model&&"mlkit"!==e.model)){t.next=2;break}return t.abrupt("return");case 2:if(g(void 0),n="wasmSimd"===e.backend?s:o){t.next=6;break}throw new Error("TFLite backend unavailable: ".concat(e.backend));case 6:return r=S(e.model,e.inputResolution),console.log("Loading tflite model:",r),t.next=10,fetch("".concat("","/models/").concat(r,".tflite"));case 10:return i=t.sent,t.next=13,i.arrayBuffer();case 13:a=t.sent,console.log("Model buffer size:",a.byteLength),c=n._getModelBufferMemoryOffset(),console.log("Model buffer memory offset:",c),console.log("Loading model buffer..."),n.HEAPU8.set(new Uint8Array(a),c),console.log("_loadModel result:",n._loadModel(a.byteLength)),console.log("Input memory offset:",n._getInputMemoryOffset()),console.log("Input height:",n._getInputHeight()),console.log("Input width:",n._getInputWidth()),console.log("Input channels:",n._getInputChannelCount()),console.log("Output memory offset:",n._getOutputMemoryOffset()),console.log("Output height:",n._getOutputHeight()),console.log("Output width:",n._getOutputWidth()),console.log("Output channels:",n._getOutputChannelCount()),g(n);case 29:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[o,s,j,e.model,e.backend,e.inputResolution]),{tflite:b,isSIMDSupported:j}};var ue=function(e){var t=e.checkedPhotoList,n=(e.setCheckedPhotoList,e.isHost),o=e.userName,i=e.meetingNumber,a=Object(r.useState)(),c=Object(u.a)(a,2),s=c[0],f=c[1],d=Object(r.useState)({type:"image",url:re[0]}),p=Object(u.a)(d,2),m=p[0],b=(p[1],Object(r.useState)({model:"meet",backend:"wasm",inputResolution:"160x96",pipeline:"webgl2"})),g=Object(u.a)(b,2),h=g[0],v=(g[1],Object(r.useState)({smoothSegmentationMask:!0,jointBilateralFilter:{sigmaSpace:1,sigmaColor:.1},coverage:[.5,.75],lightWrapping:.3,blendMode:"screen"})),j=Object(u.a)(v,2),x=j[0],O=(j[1],ae()),E=ce(h),_=E.tflite,R=(E.isSIMDSupported,Object(r.useState)(!1)),T=Object(u.a)(R,2),C=(T[0],T[1]),y=Object(r.useState)(),S=Object(u.a)(y,2),A=S[0],w=S[1],k=Object(r.useState)(),P=Object(u.a)(k,2),U=P[0],M=P[1],L=Object(r.useState)(""),D=Object(u.a)(L,2),I=D[0],B=D[1],N=Object(r.useState)(!1),H=Object(u.a)(N,2),X=H[0],W=H[1],G=Object(r.useState)(""),z=Object(u.a)(G,2),V=(z[0],z[1],Object(r.useState)(!1)),Y=Object(u.a)(V,2),K=(Y[0],Y[1],Object(r.useState)("")),Z=Object(u.a)(K,2),q=(Z[0],Z[1],Object(r.useState)(!1)),J=Object(u.a)(q,2),Q=J[0],$=J[1],te=Object(r.useRef)(),oe=Object(r.useRef)(),ie=Object(r.useRef)(),ue=void 0;return Object(r.useEffect)((function(){navigator.mediaDevices.getUserMedia({video:!0,audio:!1}).then((function(e){M(e),console.log(e),te.current.srcObject=e})),void 0===ue&&((ue=Object(F.a)("http://localhost:5002",{path:"/socket.io",transports:["websocket"]})).on("connect",(function(){console.info("connect!"),void 0!==ue&&ue.emit("join",JSON.stringify({room_id:i,isHost:n,userName:o}))})),ue.on("getid",(function(e){B(e)})),ue.on("disconnect",(function(){return console.info("disconnect!")})),w(ue))}),[]),Object(r.useEffect)((function(){if(A&&U){var e=new ne.a({initiator:!0,trickle:!1,stream:U});e.on("signal",(function(e){A.emit("caller",{room_id:i,signalData:e,from:I})})),e.on("stream",(function(e){console.log(e),oe.current.srcObject=e})),A.on("acceptcall",(function(t){W(!0),e.signal(t)})),ie.current=e}}),[i,I,A,U]),Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)("h4",{style:{color:"black"},children:"\uac80\uc0ac\ud234"}),Object(l.jsxs)("div",{style:{width:"90%",padding:"10px",height:"90vh",display:"flex",flexDirection:"column",alignItems:"center",overflowY:"auto"},children:[Object(l.jsx)("button",{onClick:function(){C(!0)},children:"\ucea1\ucc98\ud558\uae30"}),Object(l.jsx)("button",{children:"\ube44\ub514\uc624"}),X&&Object(l.jsxs)("div",{style:{width:"300px",height:"300px"},children:[Q&&Object(l.jsx)("progress",{}),Object(l.jsx)("video",{style:{width:"100%",height:"100%",visibility:"hidden",position:"absolute"},playsInline:!0,ref:oe,autoPlay:!0,muted:!0,onLoadedData:function(e){var t=e.target;f({htmlElement:t,width:t.videoWidth,height:t.videoHeight}),$(!1),console.log(t)}})]}),Object(l.jsx)("div",{id:"image-container",children:0!==t.length&&t.map((function(e,t){return Object(l.jsx)("div",{style:{width:"100%",height:"250px",marginBottom:"10px",position:"relative"},children:Object(l.jsx)("img",{style:{width:"100%",height:"100%"},src:e.image,alt:"\uadf8\ub9ac\ub4dc\ubc30\uacbd\uc774 \ub4e4\uc5b4\uac04 \uc0ac\uc9c4 ".concat(t)})},t)}))}),s&&_&&O&&Object(l.jsx)(ee,{sourcePlayback:s,backgroundConfig:m,segmentationConfig:h,postProcessingConfig:x,bodyPix:O,tflite:_})]})]})};var se=function(){return Object(l.jsx)(l.Fragment,{children:Object(l.jsx)("h4",{style:{color:"black"},children:"\uc9c4\ub2e8\uae30\ub85d"})})};var le=function(e){var t=e.meetingNumber,n=e.isHost,o=e.userName,i=Object(r.useState)(),a=Object(u.a)(i,2),c=a[0],s=a[1],f=Object(r.useState)({type:"image",url:re[0]}),d=Object(u.a)(f,2),p=d[0],m=(d[1],Object(r.useState)({model:"meet",backend:"wasm",inputResolution:"160x96",pipeline:"webgl2"})),b=Object(u.a)(m,2),g=b[0],h=(b[1],Object(r.useState)({smoothSegmentationMask:!0,jointBilateralFilter:{sigmaSpace:1,sigmaColor:.1},coverage:[.5,.75],lightWrapping:.3,blendMode:"screen"})),v=Object(u.a)(h,2),j=v[0],x=(v[1],ae()),O=ce(g),E=O.tflite,_=(O.isSIMDSupported,Object(r.useState)("")),R=Object(u.a)(_,2),T=(R[0],R[1]),C=Object(r.useState)(),y=Object(u.a)(C,2),S=y[0],A=y[1],w=Object(r.useState)(),k=Object(u.a)(w,2),P=k[0],U=k[1],M=Object(r.useState)(""),L=Object(u.a)(M,2),D=L[0],I=L[1],B=Object(r.useState)(!1),N=Object(u.a)(B,2),H=N[0],X=N[1],W=Object(r.useState)(""),G=Object(u.a)(W,2),z=G[0],V=G[1],Y=Object(r.useState)(!1),K=Object(u.a)(Y,2),Z=K[0],q=K[1],J=Object(r.useRef)(),Q=Object(r.useRef)(),$=void 0;return Object(r.useEffect)((function(){navigator.mediaDevices.getUserMedia({video:!0,audio:!1}).then((function(e){A(e),console.log(e),J.current.srcObject=e})),void 0===$&&(($=Object(F.a)("3.36.135.151:5002/",{path:"/socket.io",transports:["websocket"]})).on("connect",(function(){console.info("connect!"),void 0!==$&&$.emit("join",JSON.stringify({room_id:t,isHost:n,userName:o}))})),$.on("getid",(function(e){T(e)})),$.on("disconnect",(function(){return console.info("disconnect!")})),$.on("caller",(function(e){X(!0),I(e.from),V(e.signal),console.log(e)})),U($))}),[]),Object(r.useEffect)((function(){if(H&&D&&z&&P){var e=new ne.a({initiator:!1,trickle:!1,stream:S});e.on("signal",(function(e){P.emit("answerCall",{signal:e,to:D})})),e.signal(z),Q.current=e}}),[D,z,H,P,S]),Object(l.jsxs)("div",{children:[Object(l.jsxs)("div",{style:{width:"100%",height:"100%"},children:[Z&&Object(l.jsx)("progress",{}),Object(l.jsx)("video",{ref:J,style:{width:"100%",height:"100%",visibility:"hidden",position:"absolute"},playsInline:!0,autoPlay:!0,muted:!0,onLoadedData:function(e){var t=e.target;s({htmlElement:t,width:t.videoWidth,height:t.videoHeight}),q(!1),console.log(t)}})]}),c&&E&&x&&Object(l.jsx)(ee,{sourcePlayback:c,backgroundConfig:p,segmentationConfig:g,postProcessingConfig:j,bodyPix:x,tflite:E})]})};s.ZoomMtg.setZoomJSLib("https://source.zoom.us/2.4.5/lib","/av"),s.ZoomMtg.preLoadWasm(),s.ZoomMtg.prepareWebSDK(),s.ZoomMtg.i18n.load("ko-KO"),s.ZoomMtg.i18n.reload("ko-KO");var fe=function(){var e=Object(r.useState)("https://zoom.us/j/91314635094?pwd=bm5icWNwSTBjdEh6d05ZaUFkbVBJUT09"),t=Object(u.a)(e,2),n=t[0],o=t[1],i=Object(r.useState)(""),a=Object(u.a)(i,2),d=a[0],p=a[1],m=Object(r.useState)(!1),b=Object(u.a)(m,2),g=b[0],h=b[1],v=Object(r.useState)("1"),j=Object(u.a)(v,2),x=j[0],O=j[1],E=Object(r.useState)(""),R=Object(u.a)(E,2),T=R[0],F=R[1],y=Object(r.useState)([]),S=Object(u.a)(y,2),A=S[0],w=S[1],k=Object(r.useState)([]),P=Object(u.a)(k,2),U=P[0],M=P[1],L=Object(r.useState)([]),D=Object(u.a)(L,2),I=D[0],B=D[1],N=Object(r.useState)([]),H=Object(u.a)(N,2),X=H[0],W=H[1],G=Object(r.useState)(!1),z=Object(u.a)(G,2),V=z[0],Y=z[1],K=Object(r.useState)(""),Z=Object(u.a)(K,2),q=Z[0],J=Z[1],Q=Object(r.useState)(""),$=Object(u.a)(Q,2),ee=$[0],te=$[1];Object(r.useEffect)((function(){if(document){var e=document.location.href.split("?url=")[1];e&&o(e)}}),[]);var ne="xPN1ctkMLTAqaWGsE7FDSonJSEOO8B0XtQf8",re=n.slice(n.indexOf("/j/")+3,n.indexOf("pwd=")-1),oe=n.slice(n.indexOf("pwd=")+4,n.length);return Object(l.jsxs)("div",{className:"App",children:[Object(l.jsxs)("main",{children:[Object(l.jsx)("h1",{children:"Zoom Meeting SDK Sample React"}),Object(l.jsx)("br",{}),Object(l.jsx)("p",{children:"\uc8fc\uc18c \ucc3d\uc5d0 zoom url\uc744 \uc785\ub825\ud558\uba74 \ud574\ub2f9 ZOOM\uc73c\ub85c \uc811\uadfc\uc774 \uac00\ub2a5\ud569\ub2c8\ub2e4."}),Object(l.jsx)("br",{}),Object(l.jsxs)("p",{children:["\uc608: http://localhost:3000/?url=",n]}),Object(l.jsx)("br",{}),Object(l.jsxs)("div",{style:{display:"flex",justifyContent:"center"},children:[Object(l.jsx)("input",{type:"radio",id:"\ud2b8\ub808\uc774\ub108",name:"drone",value:"1",checked:"1"===x,onClick:function(){return O("1")}}),Object(l.jsx)("label",{htmlFor:"\ud2b8\ub808\uc774\ub108",style:{padding:"0 0 0 4px"},children:"\ud2b8\ub808\uc774\ub108(\ud638\uc2a4\ud2b8)"}),Object(l.jsx)("div",{style:{marginRight:8}}),Object(l.jsx)("input",{type:"radio",id:"\ucc38\uac00\uc790",name:"drone",value:"0",checked:"0"===x,onClick:function(){return O("0")}}),Object(l.jsx)("label",{htmlFor:"\ucc38\uac00\uc790",style:{padding:"0 0 0 4px"},children:"\ucc38\uac00\uc790"})]}),Object(l.jsx)("h2",{children:"\ucc38\uac00\uc790 \uc774\ub984"}),Object(l.jsx)("input",{value:d,onChange:function(e){return p(e.target.value)}}),Object(l.jsx)("br",{}),Object(l.jsx)("button",{onClick:function(e){e.preventDefault();var t=document.getElementById("zmmtg-root");if(t){t.style.display="block";var n={leaveUrl:"http://localhost:3000",showMeetingHeader:!0,disableInvite:!1,disableCallOut:!1,disableRecord:!1,disableJoinAudio:!1,audioPanelAlwaysOpen:!0,showPureSharingContent:!0,isSupportAV:!0,isSupportChat:!0,isSupportQA:!0,isSupportCC:!0,isSupportPolling:!0,isSupportBreakout:!0,screenShare:!0,videoDrag:!0,videoHeader:!1,isLockBottom:!1,isSupportNonverbal:!0,isShowJoiningErrorDialog:!0,inviteUrlFormat:"https://localhost:3000/?url=https://us04web.zoom.us/j/{0}?pwd={1}",meetingInfo:["participant"],disableVoIP:!1,disableReport:!1,disablePreview:!1,disableCORP:!1,onRetryCallback:!0,enableHD:!0,helper:"what"},r={signature:s.ZoomMtg.generateSDKSignature({sdkKey:ne,sdkSecret:"zaPNq6sYv9uKIUUI5wVCHGnqwnC8nG8F2p4U",meetingNumber:re,role:"0",success:function(){return console.info("generateSDKSignature success")},error:function(e){return console.info("generateSDKSignature fail",e)}}),meetingNumber:re,userName:d,sdkKey:ne,userEmail:"",passWord:oe,tk:"",success:function(e){console.log("\uc131\uacf5"),h(!0)},error:function(e){return console.log(e)}};s.ZoomMtg.init(Object(c.a)(Object(c.a)({},n),{},{success:function(e){return s.ZoomMtg.join(r)},error:function(e){return console.log(e)}}))}},children:"Join Meeting"})]}),"0"===x&&g&&Object(l.jsx)("div",{style:{width:"400px",position:"absolute",top:0,zIndex:1,right:0},children:Object(l.jsx)(le,{meetingNumber:re,isHost:x,userName:d})}),"1"===x&&g&&Object(l.jsxs)(l.Fragment,{children:[Object(l.jsxs)("div",{id:"pullim-page",style:{width:"400px",position:"absolute",top:0,zIndex:1,right:0,display:"none",height:"100vh",backgroundColor:"rgba(255,255,255)",flexDirection:"column",alignItems:"center",borderRadius:"1% 0 0 1%",overflow:"hidden"},children:["CaptureList"===ee&&Object(l.jsx)(f,{photoList:A,setPhotoList:w,setIsModal:Y,setSrc:J}),"RecordAndPrescription"===ee&&Object(l.jsx)(C,{photoList:A,uploadedPhotoList:I,setUploadedPhotoList:B,videoList:X,setVideoList:W,memo:T,setMemo:F}),"CheckTool"===ee&&Object(l.jsx)(ue,{checkedPhotoList:U,setCheckedPhotoList:M,isHost:x,userName:d,meetingNumber:re}),"DiagnosticHistory"===ee&&Object(l.jsx)(se,{})]}),Object(l.jsx)(_,{setPhotoList:w,photoList:A,setCurrentPage:te}),V&&Object(l.jsx)("div",{style:{zIndex:1,position:"absolute",width:"1100px",top:"10%",left:"10%",border:"2.5px solid orange"},children:Object(l.jsx)("img",{style:{width:"100%"},onClick:function(){Y(!1)},src:q,alt:"\ud070 \uc774\ubbf8\uc9c0"})})]})]})},de=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,633)).then((function(t){var n=t.getCLS,r=t.getFID,o=t.getFCP,i=t.getLCP,a=t.getTTFB;n(e),r(e),o(e),i(e),a(e)}))};a.a.render(Object(l.jsx)(o.a.StrictMode,{children:Object(l.jsx)(fe,{})}),document.getElementById("root")),de()}},[[631,1,2]]]);
//# sourceMappingURL=main.0ac19eec.chunk.js.map